# 更新日誌

## [2.2.3] - 2025-07-19

### 🛠 網域切換與分享 URL 修復

- 🔄 **正式網域切換**：將所有程式碼中硬編碼 `skincake.vip` 全面替換為 `skincake.tw`，並使用 `process.env.FRONTEND_DOMAIN` 作為來源。
- 🔗 **社交分享 URL**：文章頁分享按鈕、JSON-LD `mainEntityOfPage`、OpenGraph、Twitter Card 全面改用 `https://skincake.tw`。
- 🌐 **Sitemap 改善**：`server-sitemap.xml` 使用百分比編碼分類 `slug`，並排除重複的 `/server-sitemap.xml` 自身。
- 🚀 **Next config**：預設 `FRONTEND_DOMAIN` 改為 `https://skincake.tw`。

---

## [2.2.2] - 2025-01-19

### ✨ 分類頁面與文章頁面 UI/UX 完整修復

- ✅ **分類頁面樣式修正**
  - **頁面寬度統一**：將頁面最大寬度限制為 `1080px`，與導航列對齊。
  - **關鍵字區塊優化**：移除多餘的白色背景和內邊距，視覺更整合。
  - **文章卡片樣式統一**：
    - 圖片比例調整為 `16:9`，匹配線上版本。
    - 恢復顯示分類標籤和日期，並置於同一行。
    - 調整標題為灰色、字體稍大 (`text-base`) 且限制兩行，符合最終樣式。
  - **Cakery (0) 顯示問題**：修正 API 邏輯 (`hide_empty=false`)，確保文章數為 0 的分類也能正常顯示。

- ✅ **文章頁面麵包屑修復**
  - **解決排版擁擠**：移除麵包屑中的文章標題，只顯示到分類層級，確保在窄螢幕上也能水平排列。
  - **連結功能修復**：修正 `Breadcrumb` 組件邏輯，確保所有帶 `href` 的項目（包括分類名稱）都能正確渲染為可點擊的連結。

- ✅ **Hydration 錯誤修復**
  - 統一 `decodeHtml` 函數，避免伺服器端和客戶端渲染不一致導致的 `Suspense boundary` Hydration 錯誤。

## [2.2.1] - 2025-01-18

### 🚀 快取效能大幅優化
- ✅ **修復生產環境快取策略錯誤**
  - 之前：生產環境每次都重新獲取資料（cache: 'no-store'）
  - 現在：生產環境正確使用 ISR 快取（revalidate: 3600）
- ✅ **統一快取時間設定**
  - 文章內容：1小時自動更新
  - 分類/標籤：2小時自動更新
  - 隨機推薦：保持即時更新
- ✅ **增加預渲染覆蓋率**
  - 從預渲染 20 篇文章增加到 50 篇
  - 更多文章享受瞬間載入體驗
- ✅ **GCP Cloud Run 特別優化**
  - 添加 Cache-Control 標頭
  - 保持 API 效能與快取平衡

### 📈 效能改善預期
- 首次訪問：正常載入時間
- 重複訪問：幾乎瞬間載入
- 前50篇文章：預渲染極速體驗
- 其他文章：訪問後快取，後續快速載入

## [2.2.0] - 2025-01-18

### 🎯 文章頁面完整修復
- ✅ 完全匹配線上版本的樣式佈局
- ✅ 修復圖片顯示位置（頂部大圖、下方內容）
- ✅ 優化文字閱讀體驗（行高、字體大小、段落間距）
- ✅ 修復社交分享功能（Facebook、Threads、複製連結）
- ✅ 實現隨機相關文章推薦（含手動重新整理功能）

### 🚀 SEO 大幅優化
- ✅ 動態 Sitemap 生成（next-sitemap + server-sitemap）
- ✅ 結構化數據完整支援（JSON-LD）
- ✅ 優化 metadata 和 Open Graph 標籤
- ✅ Canonical URLs 避免重複內容
- ✅ 自動排程重建（GitHub Actions）
- ✅ 靜態頁面預渲染（ISR 1小時）
- ✅ 麵包屑導航強化內部連結
- ✅ 全站圖片優化（Next.js Image 元件）

### 🎨 效能與使用者體驗
- ✅ 優化字體載入（display: swap）
- ✅ 預連接重要資源（preconnect/dns-prefetch）
- ✅ 改善圖片載入效能（尺寸優化、lazy loading）
- ✅ 增強 alt 文字改善無障礙性

## [2.1.0] - 2025-01-17

### ✨ 首頁修復與優化
- 修復蛋糕報報區塊重複標題問題
- 修復偷偷推薦給你區塊重複標題問題  
- 恢復淡粉紅色背景設計
- 優化區塊間距和視覺效果
- 完成首頁所有功能區塊的樣式統一

### 📌 待修復
- 文章頁樣式與功能
- 分類頁樣式與功能
- 搜尋頁樣式與功能

## [2.0.0] - 2025-01-12

### 🎉 重大更新 - 完全重構
- 從舊版 SPA 架構遷移到 Next.js 14
- 全新的 TypeScript + Tailwind CSS 技術棧
- WordPress REST API 深度整合
- 響應式設計全面優化

---

[查看完整更新歷史](./docs/CHANGELOG.md) 